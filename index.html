<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FRC ALL â€” Painel</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#0B0D12;--bg2:#13161E;--bg3:#1B1F2A;--bg4:#252A38;--bdr:#2B3142;--tx:#E8ECF4;--tx2:#8B95A8;--tx3:#5A6478;--acc:#E87722;--acc2:#FF9A4D;--red:#EF4444;--grn:#22C55E;--ylw:#EAB308;--blu:#3B82F6;--pur:#A855F7}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--tx);min-height:100vh}
.app{display:flex;min-height:100vh}
.sb{width:260px;min-width:260px;background:var(--bg2);border-right:1px solid var(--bdr);height:100vh;position:sticky;top:0;overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--bg4) transparent;display:flex;flex-direction:column}
.sb-hd{padding:18px;border-bottom:1px solid var(--bdr);background:linear-gradient(135deg,#0a1a00,#0B0D12)}
.sb-logo{font-family:'Space Mono',monospace;font-size:17px;font-weight:700;color:var(--grn)}
.sb-sub{font-size:10px;color:var(--tx3);margin-top:3px;text-transform:uppercase;letter-spacing:1.5px}
.sb-grp{padding:14px 14px 4px;font-size:9px;text-transform:uppercase;letter-spacing:1.5px;font-weight:700}
.sb-item{display:flex;align-items:center;gap:8px;padding:7px 14px 7px 22px;cursor:pointer;font-size:12.5px;color:var(--tx2);border-left:3px solid transparent;transition:.15s}
.sb-item:hover{background:var(--bg3);color:var(--tx)}
.sb-item.act{background:var(--bg3);color:var(--acc);border-left-color:var(--acc);font-weight:600}
.sb-item .ic{font-size:14px;width:20px;text-align:center}
.sb-top{display:flex;align-items:center;gap:8px;padding:10px 14px;cursor:pointer;font-size:13px;font-weight:600;color:var(--tx);border-left:3px solid transparent;transition:.15s}
.sb-top:hover{background:var(--bg3)}
.sb-top.act{background:var(--bg3);color:var(--acc);border-left-color:var(--acc)}
.sb-link{margin-top:auto;padding:14px;border-top:1px solid var(--bdr)}
.sb-link a{display:block;text-align:center;padding:10px;background:var(--bg3);border:1px solid var(--bdr);border-radius:8px;color:var(--acc);font-size:12px;font-weight:600;text-decoration:none;transition:.15s}
.sb-link a:hover{background:var(--acc);color:#fff}
.mn{flex:1;padding:24px 28px;overflow-y:auto;min-height:100vh}
.pg-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;padding-bottom:18px;border-bottom:1px solid var(--bdr);flex-wrap:wrap;gap:8px}
.pg-tt{font-family:'Space Mono',monospace;font-size:20px;font-weight:700;display:flex;align-items:center;gap:10px}
.pg-badge{font-size:10px;padding:3px 10px;border-radius:20px;font-family:'DM Sans';font-weight:600}
.card{background:var(--bg2);border:1px solid var(--bdr);border-radius:10px;padding:18px;margin-bottom:18px}
.card-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.card-tt{font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:.8px;display:flex;align-items:center;gap:8px}
.st-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;margin-bottom:22px}
.st-card{background:var(--bg2);border:1px solid var(--bdr);border-radius:10px;padding:14px;position:relative;overflow:hidden}
.st-card .bar{position:absolute;top:0;left:0;right:0;height:3px}
.st-lb{font-size:10px;color:var(--tx3);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px}
.st-val{font-family:'Space Mono',monospace;font-size:24px;font-weight:700}
.st-sub{font-size:11px;color:var(--tx2);margin-top:3px}
.sec-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:12px}
.sec-card{background:var(--bg2);border:1px solid var(--bdr);border-radius:10px;padding:14px;cursor:pointer;transition:.2s;position:relative;overflow:hidden}
.sec-card:hover{border-color:var(--acc);transform:translateY(-2px);box-shadow:0 6px 20px rgba(0,0,0,.3)}
.sec-card .bar{position:absolute;bottom:0;left:0;right:0;height:3px}
.sec-top{display:flex;align-items:center;gap:8px;margin-bottom:8px}
.sec-ic{font-size:22px}
.sec-nm{font-size:13px;font-weight:700}
.sec-ld{font-size:10px;color:var(--tx3)}
.sec-stats{display:flex;gap:14px;margin-top:8px;font-size:11px;color:var(--tx2)}
.sec-stats span{font-weight:700;color:var(--tx)}
.tabs{display:flex;gap:2px;margin-bottom:18px;border-bottom:1px solid var(--bdr);flex-wrap:wrap}
.tab{padding:8px 14px;font-size:11.5px;font-weight:500;cursor:pointer;color:var(--tx3);border-bottom:2px solid transparent;transition:.15s;white-space:nowrap}
.tab:hover{color:var(--tx2)}
.tab.act{color:var(--acc);border-bottom-color:var(--acc);font-weight:700}
.tw{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:12px}
th{text-align:left;padding:8px 10px;font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--tx3);font-weight:700;border-bottom:1px solid var(--bdr);white-space:nowrap}
td{padding:8px 10px;border-bottom:1px solid var(--bdr);vertical-align:top}
tr:hover td{background:var(--bg3)}
.bdg{display:inline-block;padding:2px 7px;border-radius:10px;font-size:10px;font-weight:600}
.bdg-p{background:rgba(234,179,8,.15);color:var(--ylw)}
.bdg-a{background:rgba(59,130,246,.15);color:var(--blu)}
.bdg-c{background:rgba(34,197,94,.15);color:var(--grn)}
.bdg-b{background:rgba(239,68,68,.15);color:var(--red)}
.vis-lb{font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--tx3);font-weight:700}
.vis-val{font-size:13px;color:var(--tx);margin-top:4px;line-height:1.6;white-space:pre-wrap}
.vis-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.empty{text-align:center;padding:30px 20px;color:var(--tx3);font-size:12px}
.empty-ic{font-size:30px;margin-bottom:10px}
.eis-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.eis-quad{border:1px solid var(--bdr);border-radius:10px;padding:14px;min-height:80px}
.eis-hd{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px;display:flex;align-items:center;gap:6px}
.eis-item{background:var(--bg3);border:1px solid var(--bdr);border-radius:6px;padding:8px 10px;margin-bottom:6px;font-size:11.5px}
.eis-item-meta{display:flex;gap:10px;margin-top:4px;font-size:10px;color:var(--tx3)}
.rot-card{background:var(--bg3);border:1px solid var(--bdr);border-radius:8px;padding:12px;margin-bottom:8px}
.rot-freq{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:1px;padding:2px 7px;border-radius:10px}
.flow-node{background:var(--bg3);border:2px solid var(--bdr);border-radius:10px;padding:12px 16px;text-align:center}
.flow-arrow{display:flex;justify-content:center;padding:6px 0;color:var(--tx3);font-size:16px}
.flow-pen{font-size:10px;color:var(--red);margin-top:4px;font-style:italic}
.org-tree{display:flex;flex-direction:column;align-items:center;padding:20px 0}
.org-branch{display:flex;flex-direction:column;align-items:center}
.org-children{display:flex;gap:16px;justify-content:center;position:relative;padding-top:20px}
.org-children::before{content:'';position:absolute;top:0;left:50%;width:calc(100% - 80px);height:1px;background:var(--bdr);transform:translateX(-50%)}
.org-children>.org-branch{position:relative}
.org-children>.org-branch::before{content:'';position:absolute;top:-20px;left:50%;width:1px;height:20px;background:var(--bdr)}
.org-line{width:1px;height:20px;background:var(--bdr);margin:0 auto}
.org-node{background:var(--bg2);border:2px solid var(--bdr);border-radius:10px;padding:10px 14px;min-width:120px;text-align:center;position:relative}
.org-lvl{position:absolute;top:-8px;left:50%;transform:translateX(-50%);font-size:8px;font-weight:700;text-transform:uppercase;letter-spacing:1px;padding:1px 8px;border-radius:8px;color:#fff;white-space:nowrap}
.org-nm{font-size:12px;font-weight:700;margin-top:6px}
.org-cg{font-size:10px;color:var(--tx2);margin-top:2px}
.com-lvl{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:14px}
.com-card{border:2px solid var(--bdr);border-radius:10px;padding:14px;text-align:center;position:relative;overflow:hidden}
.com-card .bar{position:absolute;top:0;left:0;right:0;height:3px}
.com-icon{font-size:24px;margin-bottom:4px}
.com-nm{font-size:13px;font-weight:700;margin-bottom:2px}
.com-pct{font-family:'Space Mono',monospace;font-size:11px;color:var(--tx2)}
.com-val{font-family:'Space Mono',monospace;font-size:16px;font-weight:700;margin-top:4px}
.jor-flow{max-width:600px;margin:0 auto}
.jor-node{background:var(--bg3);border:2px solid var(--bdr);border-radius:10px;padding:14px;display:flex;align-items:start;gap:12px}
.jor-num{background:var(--acc);color:#fff;font-size:11px;font-weight:700;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.jor-arrow{display:flex;justify-content:center;padding:4px 0;color:var(--tx3);font-size:14px}
.jor-setor{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:1px;padding:2px 7px;border-radius:10px;display:inline-block;margin-top:4px}
.rf{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:12px}
.rf-btn{padding:5px 12px;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;border:1px solid var(--bdr);background:var(--bg3);color:var(--tx2);transition:.15s}
.rf-btn:hover{border-color:var(--tx2)}
.rf-btn.act{background:var(--acc);color:#fff;border-color:var(--acc)}
.cal{border:1px solid var(--bdr);border-radius:8px;overflow:hidden}
.cal-hd{display:grid;grid-template-columns:repeat(7,1fr);background:var(--bg4)}
.cal-hd div{padding:6px;text-align:center;font-size:9px;font-weight:700;text-transform:uppercase;color:var(--tx3);letter-spacing:1px}
.cal-body{display:grid;grid-template-columns:repeat(7,1fr)}
.cal-day{padding:6px 4px;min-height:44px;border:1px solid var(--bdr);font-size:11px;text-align:center}
.cal-day.empty{background:var(--bg)}
.cal-day.today{background:rgba(232,119,34,.12);font-weight:700;color:var(--acc)}
.cal-day.hol{background:rgba(239,68,68,.08)}
.cal-hol{font-size:7px;color:var(--red);font-weight:600;margin-top:2px;line-height:1.1}
.cal-hol-br{color:var(--grn)}
.cal-nav{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;background:var(--bg3);border-bottom:1px solid var(--bdr)}
.cal-nav-tt{font-size:13px;font-weight:700}
.cal-nav button{background:var(--bg4);border:1px solid var(--bdr);color:var(--tx);padding:4px 10px;border-radius:5px;cursor:pointer;font-size:12px}
.live{display:inline-block;width:8px;height:8px;background:var(--grn);border-radius:50%;animation:pulse 1.5s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
@media(max-width:768px){
.sb{width:52px;min-width:52px}.sb-hd{padding:10px 6px;text-align:center}.sb-sub,.sb-grp,.sb-item .nm,.sb-top .nm,.sb-link{display:none}.sb-logo{font-size:12px}.sb-item{padding:8px;justify-content:center}.sb-top{justify-content:center}.mn{padding:14px}.vis-grid,.eis-grid,.com-lvl{grid-template-columns:1fr 1fr}.st-grid{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>
<body>
<div class="app" id="app"></div>
<script>
var SECTORS=[
{id:"mkt",name:"Marketing",icon:"ğŸ“£",group:"Vendas & Marketing",leader:"",color:"#E87722"},
{id:"comercial",name:"Comercial",icon:"ğŸ’°",group:"Vendas & Marketing",leader:"",color:"#D4380D"},
{id:"kommo",name:"Kommo (CRM)",icon:"ğŸ“‹",group:"Vendas & Marketing",leader:"",color:"#FA8C16"},
{id:"operacional",name:"Operacional",icon:"âš™ï¸",group:"OperaÃ§Ã£o & LogÃ­stica",leader:"",color:"#1890FF"},
{id:"entdev",name:"Ent/DevoluÃ§Ã£o",icon:"ğŸš—",group:"OperaÃ§Ã£o & LogÃ­stica",leader:"",color:"#096DD9"},
{id:"frota",name:"Frota",icon:"ğŸ…¿ï¸",group:"OperaÃ§Ã£o & LogÃ­stica",leader:"",color:"#0050B3"},
{id:"oficina",name:"Oficina",icon:"ğŸ”§",group:"OperaÃ§Ã£o & LogÃ­stica",leader:"",color:"#003A8C"},
{id:"cegonha",name:"Cegonha",icon:"ğŸšš",group:"OperaÃ§Ã£o & LogÃ­stica",leader:"",color:"#002766"},
{id:"coo",name:"COO",icon:"ğŸ¯",group:"OperaÃ§Ã£o & LogÃ­stica",leader:"",color:"#13C2C2"},
{id:"disponibilidade",name:"Disponibilidade",icon:"ğŸ“Š",group:"OperaÃ§Ã£o & LogÃ­stica",leader:"Queren",color:"#006D75"},
{id:"posvenda",name:"PÃ³s-venda",icon:"ğŸ“",group:"Cliente",leader:"",color:"#52C41A"},
{id:"suporte",name:"Suporte",icon:"ğŸ†˜",group:"Cliente",leader:"",color:"#389E0D"},
{id:"cs",name:"CS (Ritmo)",icon:"â±ï¸",group:"Cliente",leader:"",color:"#237804"},
{id:"sucesso",name:"Sucesso Cliente",icon:"â­",group:"Cliente",leader:"",color:"#135200"},
{id:"financeiro",name:"Financeiro",icon:"ğŸ¦",group:"Backoffice",leader:"Daniela",color:"#722ED1"},
{id:"pessoas",name:"Pessoas e Cultura",icon:"ğŸ‘¥",group:"Backoffice",leader:"JoÃ£o Victor",color:"#531DAB"},
{id:"qualidade",name:"Qualidade",icon:"âœ…",group:"Backoffice",leader:"Eduardo",color:"#391085"},
{id:"update",name:"Update",icon:"ğŸ”„",group:"Backoffice",leader:"",color:"#EB2F96"},
{id:"dashboard_bi",name:"Dashboard (BI)",icon:"ğŸ“ˆ",group:"Sistemas",leader:"",color:"#C41D7F"},
{id:"dunas",name:"Dunas (Sistema)",icon:"ğŸ’»",group:"Sistemas",leader:"",color:"#9E1068"},
{id:"apn",name:"APN (Parceiro)",icon:"ğŸ¤",group:"Sistemas",leader:"",color:"#780650"},
{id:"ia",name:"IA (AutomaÃ§Ã£o)",icon:"ğŸ¤–",group:"EstratÃ©gico",leader:"",color:"#FAAD14"},
{id:"plus",name:"Plus (InovaÃ§Ã£o)",icon:"ğŸš€",group:"EstratÃ©gico",leader:"",color:"#D48806"},
{id:"clube",name:"Clube Banco",icon:"ğŸ’³",group:"EstratÃ©gico",leader:"",color:"#AD6800"},
];
var GROUPS=["Vendas & Marketing","OperaÃ§Ã£o & LogÃ­stica","Cliente","Backoffice","Sistemas","EstratÃ©gico"];
var GCOL={"Vendas & Marketing":"#E87722","OperaÃ§Ã£o & LogÃ­stica":"#1890FF","Cliente":"#52C41A","Backoffice":"#722ED1","Sistemas":"#C41D7F","EstratÃ©gico":"#FAAD14"};
var MOS=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"];
var STS=["Pendente","Em andamento","ConcluÃ­do","Bloqueado"];
var STABS=[{id:"vision",l:"VisÃ£o",i:"ğŸ¯"},{id:"pendencias",l:"PendÃªncias",i:"ğŸ”´"},{id:"tarefas",l:"Tarefas",i:"ğŸŸ "},{id:"entregas",l:"Entregas",i:"ğŸ“¦"},{id:"kpimetas",l:"KPIs & Metas",i:"ğŸ“Š"},{id:"rotinas",l:"Rotinas",i:"ğŸ“…"},{id:"fluxo",l:"Fluxo",i:"ğŸ”€"},{id:"orgsetor",l:"Organograma",i:"ğŸ¢"},{id:"comissao",l:"ComissÃ£o",i:"ğŸ’²"},{id:"notes",l:"Notas CEO",i:"ğŸ“"}];
var LVLS=[{id:"bronze",name:"Bronze",icon:"ğŸ¥‰",color:"#CD7F32",pct:"70-79%"},{id:"prata",name:"Prata",icon:"ğŸ¥ˆ",color:"#C0C0C0",pct:"80-89%"},{id:"ouro",name:"Ouro",icon:"ğŸ¥‡",color:"#FFD700",pct:"90-99%"},{id:"diamante",name:"Diamante",icon:"ğŸ’",color:"#B9F2FF",pct:"100%+"}];
var HOLIDAYS={"2026-01-01":{t:"Ano Novo",f:"ğŸ‡§ğŸ‡·ğŸ‡ºğŸ‡¸"},"2026-01-20":{t:"MLK Day",f:"ğŸ‡ºğŸ‡¸"},"2026-02-16":{t:"Carnaval",f:"ğŸ‡§ğŸ‡·"},"2026-02-17":{t:"Carnaval",f:"ğŸ‡§ğŸ‡·"},"2026-04-03":{t:"Sexta-feira Santa",f:"ğŸ‡§ğŸ‡·"},"2026-04-05":{t:"PÃ¡scoa",f:"ğŸ‡§ğŸ‡·ğŸ‡ºğŸ‡¸"},"2026-04-21":{t:"Tiradentes",f:"ğŸ‡§ğŸ‡·"},"2026-05-01":{t:"Dia do Trabalho",f:"ğŸ‡§ğŸ‡·"},"2026-05-25":{t:"Memorial Day",f:"ğŸ‡ºğŸ‡¸"},"2026-06-04":{t:"Corpus Christi",f:"ğŸ‡§ğŸ‡·"},"2026-07-04":{t:"Independence Day",f:"ğŸ‡ºğŸ‡¸"},"2026-09-07":{t:"Indep. Brasil",f:"ğŸ‡§ğŸ‡·"},"2026-10-12":{t:"N.S. Aparecida / Columbus",f:"ğŸ‡§ğŸ‡·ğŸ‡ºğŸ‡¸"},"2026-11-02":{t:"Finados",f:"ğŸ‡§ğŸ‡·"},"2026-11-11":{t:"Veterans Day",f:"ğŸ‡ºğŸ‡¸"},"2026-11-15":{t:"ProclamaÃ§Ã£o Rep.",f:"ğŸ‡§ğŸ‡·"},"2026-11-26":{t:"Thanksgiving",f:"ğŸ‡ºğŸ‡¸"},"2026-12-25":{t:"Natal",f:"ğŸ‡§ğŸ‡·ğŸ‡ºğŸ‡¸"}};
var FREQ_COLS={"diario":"var(--acc)","semanal":"var(--blu)","quinzenal":"var(--pur)","mensal":"var(--grn)"};
var stMap={"Pendente":"bdg-p","Em andamento":"bdg-a","ConcluÃ­do":"bdg-c","Bloqueado":"bdg-b","Planejada":"bdg-p","Entregue":"bdg-c","Atrasada":"bdg-b","Cancelada":"bdg-p"};

var DB="frc-all-data";var D={};var PG="dashboard";var TB="vision";var EMO=new Date().getMonth();var KMO=new Date().getMonth();var KMETA=null;var RFILT="todos";var CALMO=new Date().getMonth();var CALYR=2026;

function load(){try{var x=localStorage.getItem(DB);D=x?JSON.parse(x):{}}catch(e){D={}}}
function gS(id){if(!D[id])D[id]={};var s=D[id];if(!s.vision)s.vision={};if(!s.pendencias)s.pendencias=[];if(!s.tarefas)s.tarefas=[];if(!s.entregas)s.entregas={};if(!s.kpimetas)s.kpimetas=[];if(!s.rotinas)s.rotinas=[];if(!s.fluxo)s.fluxo=[];if(!s.orgNodes)s.orgNodes=[];if(!s.comissao)s.comissao={ajudaCusto:"",regras:[],niveis:{}};if(!s.notes)s.notes="";return s}

function R(){
  load();
  document.getElementById("app").innerHTML=
  '<div class="sb">'+
    '<div class="sb-hd"><div class="sb-logo">FRC ALL</div><div class="sb-sub"><span class="live"></span> Painel</div></div>'+
    '<div class="sb-top '+(PG==="dashboard"?"act":"")+'" onclick="PG=\'dashboard\';R()"><span class="ic">ğŸ†</span><span class="nm">Dashboard</span></div>'+
    '<div class="sb-top '+(PG==="ceo"?"act":"")+'" onclick="PG=\'ceo\';TB=\'vision\';R()"><span class="ic">ğŸ‘”</span><span class="nm">CEO Geral</span></div>'+
    GROUPS.map(function(g){return '<div class="sb-grp" style="color:'+GCOL[g]+'">'+g+'</div>'+SECTORS.filter(function(s){return s.group===g}).map(function(s){return '<div class="sb-item '+(PG===s.id?"act":"")+'" onclick="PG=\''+s.id+'\';TB=\'vision\';R()"><span class="ic">'+s.icon+'</span><span class="nm">'+s.name+'</span></div>'}).join("")}).join("")+
    '<div class="sb-link"><a href="admin.html" target="_blank">âš¡ Admin</a></div>'+
  '</div>'+
  '<div class="mn">'+(PG==="dashboard"?rDash():PG==="ceo"?rCEO():rSec(PG))+'</div>';
}

// ===== DASHBOARD =====
function rDash(){
  var tP=0,tT=0,tK=0,tE=0;
  SECTORS.forEach(function(s){var d=gS(s.id);tP+=(d.pendencias||[]).filter(function(x){return x.status!=="ConcluÃ­do"}).length;tT+=(d.tarefas||[]).filter(function(x){return x.status!=="ConcluÃ­do"}).length;tK+=(d.kpimetas||[]).length;for(var mk in d.entregas){tE+=(d.entregas[mk]||[]).filter(function(x){return x.status==="Entregue"}).length}});
  return '<div class="pg-hd"><div class="pg-tt">ğŸ† FRC ALL â€” Painel <span class="live"></span></div><span class="pg-badge" style="background:rgba(34,197,94,.15);color:#22C55E">24 Setores</span></div>'+
    '<div class="st-grid">'+
    '<div class="st-card"><div class="bar" style="background:var(--red)"></div><div class="st-lb">PendÃªncias</div><div class="st-val" style="color:var(--red)">'+tP+'</div><div class="st-sub">abertas</div></div>'+
    '<div class="st-card"><div class="bar" style="background:var(--ylw)"></div><div class="st-lb">Tarefas</div><div class="st-val" style="color:var(--ylw)">'+tT+'</div><div class="st-sub">futuras</div></div>'+
    '<div class="st-card"><div class="bar" style="background:var(--blu)"></div><div class="st-lb">KPIs & Metas</div><div class="st-val" style="color:var(--blu)">'+tK+'</div><div class="st-sub">cadastradas</div></div>'+
    '<div class="st-card"><div class="bar" style="background:var(--grn)"></div><div class="st-lb">Entregas</div><div class="st-val" style="color:var(--grn)">'+tE+'</div><div class="st-sub">concluÃ­das</div></div>'+
    '</div>'+
    GROUPS.map(function(g){return '<div style="margin-bottom:20px"><div style="font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:'+GCOL[g]+';margin-bottom:10px">'+g+'</div><div class="sec-grid">'+SECTORS.filter(function(s){return s.group===g}).map(function(s){var d=gS(s.id);var p=(d.pendencias||[]).filter(function(x){return x.status!=="ConcluÃ­do"}).length;return '<div class="sec-card" onclick="PG=\''+s.id+'\';TB=\'vision\';R()"><div class="sec-top"><span class="sec-ic">'+s.icon+'</span><div><div class="sec-nm">'+s.name+'</div><div class="sec-ld">'+(s.leader||"â€”")+'</div></div></div><div class="sec-stats"><div>Pend: <span style="color:'+(p>0?'var(--red)':'var(--grn)')+'">'+p+'</span></div><div>KPIs: <span>'+(d.kpimetas||[]).length+'</span></div></div><div class="bar" style="background:'+s.color+'"></div></div>'}).join("")+'</div></div>'}).join("");
}

// ===== CEO =====
function rCEO(){
  var c=D._ceo||{};
  var tabs=[{id:"vision",l:"VisÃ£o",i:"ğŸ¯"},{id:"prioridades",l:"Prioridades",i:"ğŸ”¥"},{id:"jornada",l:"Jornada Cliente",i:"ğŸ—ºï¸"},{id:"tarefasCeo",l:"Tarefas Futuras",i:"ğŸŸ "},{id:"rotinas",l:"Rotinas",i:"ğŸ“…"},{id:"organograma",l:"Organograma",i:"ğŸ¢"},{id:"fluxos",l:"Fluxos",i:"ğŸ”€"},{id:"notes",l:"Notas",i:"ğŸ“"}];
  var hd='<div class="pg-hd"><div class="pg-tt">ğŸ‘” CEO Geral</div><span class="pg-badge" style="background:rgba(232,119,34,.15);color:#E87722">Fabinho</span></div><div class="tabs">'+tabs.map(function(t){return '<div class="tab '+(TB===t.id?"act":"")+'" onclick="TB=\''+t.id+'\';R()">'+t.i+' '+t.l+'</div>'}).join("")+'</div>';
  if(TB==="jornada")return hd+vJornada(c);
  if(TB==="tarefasCeo")return hd+vTarefasCeo();
  if(TB==="organograma")return hd+vOrgCeo(c);
  var val=c[TB]||"";
  if(!val)return hd+'<div class="card"><div class="empty"><div class="empty-ic">ğŸ“</div>Sem conteÃºdo</div></div>';
  return hd+'<div class="card"><div class="card-tt" style="margin-bottom:14px">'+(tabs.find(function(t){return t.id===TB})||{}).i+' '+(tabs.find(function(t){return t.id===TB})||{}).l+'</div><div class="vis-val">'+val+'</div></div>';
}

var JOR_PHASES=[
{from:1,to:1,name:"O SONHO",color:"#FAAD14",icon:"âœ¨"},
{from:2,to:3,name:"MARKETING & TRÃFEGO",color:"#E87722",icon:"ğŸ“£"},
{from:4,to:8,name:"IA / FOLLOW-UP",color:"#13C2C2",icon:"ğŸ¤–"},
{from:9,to:15,name:"COMERCIAL EM ATENDIMENTO",color:"#D4380D",icon:"ğŸ’°"},
{from:16,to:22,name:"PÃ“S-VENDA & LOGÃSTICA",color:"#52C41A",icon:"ğŸ“"},
{from:23,to:25,name:"LOGÃSTICA â€” ENTREGA",color:"#096DD9",icon:"ğŸš—"},
{from:26,to:29,name:"SUPORTE",color:"#389E0D",icon:"ğŸ†˜"},
{from:30,to:32,name:"LOGÃSTICA â€” DEVOLUÃ‡ÃƒO",color:"#096DD9",icon:"ğŸš—"},
{from:33,to:37,name:"SUCESSO DO CLIENTE",color:"#135200",icon:"â­"},
{from:38,to:43,name:"FINANCEIRO â€” REEMBOLSO",color:"#722ED1",icon:"ğŸ¦"},
];

function vJornada(c){
  var items=(c.jornada||[]).slice().sort(function(a,b){return(a.ordem||0)-(b.ordem||0)});
  if(!items.length)return '<div class="card"><div class="empty"><div class="empty-ic">ğŸ—ºï¸</div>Jornada nÃ£o configurada</div></div>';
  var flow='';
  for(var p=0;p<JOR_PHASES.length;p++){
    var ph=JOR_PHASES[p];
    var phItems=items.filter(function(s){return s.ordem>=ph.from&&s.ordem<=ph.to});
    if(!phItems.length)continue;
    flow+='<div style="margin-bottom:20px"><div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;padding:8px 14px;background:'+ph.color+'15;border-left:4px solid '+ph.color+';border-radius:0 8px 8px 0"><span style="font-size:16px">'+ph.icon+'</span><span style="font-size:12px;font-weight:700;color:'+ph.color+';text-transform:uppercase;letter-spacing:1px">'+ph.name+'</span><span style="font-size:10px;color:var(--tx3);margin-left:auto">'+phItems.length+' etapas</span></div>';
    for(var i=0;i<phItems.length;i++){
      var s=phItems[i];var secCol=ph.color;
      for(var si=0;si<SECTORS.length;si++){if(s.setor&&s.setor.toLowerCase().indexOf(SECTORS[si].name.toLowerCase())>=0){secCol=SECTORS[si].color;break}}
      flow+='<div class="jor-node" style="margin-left:20px"><div class="jor-num" style="background:'+ph.color+'">'+s.ordem+'</div><div style="flex:1"><div style="font-size:13px;font-weight:700">'+s.etapa+'</div><div class="jor-setor" style="background:'+secCol+'22;color:'+secCol+'">'+s.setor+'</div>';
      if(s.desc)flow+='<div style="font-size:11px;color:var(--tx2);margin-top:4px">'+s.desc+'</div>';
      if(s.acao)flow+='<div style="font-size:11px;color:var(--grn);margin-top:2px">â†’ '+s.acao+'</div>';
      flow+='</div></div>';
      if(i<phItems.length-1)flow+='<div class="jor-arrow" style="margin-left:34px">â–¼</div>';
    }
    flow+='</div>';
  }
  var orphans=items.filter(function(s){var inP=false;JOR_PHASES.forEach(function(ph){if(s.ordem>=ph.from&&s.ordem<=ph.to)inP=true});return!inP});
  if(orphans.length){flow+='<div style="margin-bottom:20px"><div style="font-size:10px;font-weight:700;color:var(--tx3);margin-bottom:8px">ETAPAS ADICIONAIS</div>';for(var i=0;i<orphans.length;i++){var s=orphans[i];flow+='<div class="jor-node"><div class="jor-num">'+s.ordem+'</div><div style="flex:1"><div style="font-size:13px;font-weight:700">'+s.etapa+'</div><div class="jor-setor" style="background:var(--bg4);color:var(--tx2)">'+s.setor+'</div>';if(s.desc)flow+='<div style="font-size:11px;color:var(--tx2);margin-top:4px">'+s.desc+'</div>';flow+='</div></div>'}flow+='</div>'}
  return '<div class="card"><div class="card-tt" style="margin-bottom:14px">ğŸ—ºï¸ Jornada do Cliente â€” Florida Rental Car ('+items.length+' etapas â€¢ 10 fases)</div><div class="jor-flow">'+flow+'</div></div>';
}

function vTarefasCeo(){
  var all=[];
  SECTORS.forEach(function(s){var d=gS(s.id);(d.tarefas||[]).forEach(function(t){all.push({setor:s.name,icon:s.icon,color:s.color,desc:t.desc,responsavel:t.responsavel,previsao:t.previsao,deps:t.deps,status:t.status})})});
  var open=all.filter(function(x){return x.status!=="ConcluÃ­do"});
  if(!all.length)return '<div class="card"><div class="empty"><div class="empty-ic">ğŸŸ </div>Nenhuma tarefa nos setores</div></div>';
  var rows='';for(var i=0;i<open.length;i++){var t=open[i];rows+='<tr><td><span style="font-size:14px">'+t.icon+'</span> <span style="font-size:11px;color:'+t.color+';font-weight:600">'+t.setor+'</span></td><td>'+t.desc+'</td><td>'+(t.responsavel||"â€”")+'</td><td style="font-size:11px">'+(t.previsao||"â€”")+'</td><td><span class="bdg '+(stMap[t.status]||"bdg-p")+'">'+t.status+'</span></td></tr>'}
  return '<div class="card"><div class="card-hd"><div class="card-tt">ğŸŸ  Tarefas Futuras</div><span style="font-size:11px;color:var(--tx3)">'+open.length+' abertas</span></div><div class="tw"><table><thead><tr><th>Setor</th><th>Tarefa</th><th>ResponsÃ¡vel</th><th>PrevisÃ£o</th><th>Status</th></tr></thead><tbody>'+rows+'</tbody></table></div></div>';
}

function vOrgCeo(c){
  var nodes=c.orgNodes||[];
  if(!nodes.length)return '<div class="card"><div class="empty"><div class="empty-ic">ğŸ¢</div>Organograma nÃ£o configurado</div></div>';
  function getK(pid){return nodes.filter(function(n){return n.parentId===pid})}
  function bT(pid,lvl){
    var kids=getK(pid);if(!kids.length)return'';
    var h='<div class="org-children">';
    for(var i=0;i<kids.length;i++){var n=kids[i];var sk=getK(n.id);var lc=lvl===0?'var(--acc)':lvl===1?'var(--blu)':'var(--pur)';var ll=lvl===0?'CEO':lvl===1?'GerÃªncia':'LideranÃ§a';
    h+='<div class="org-branch"><div class="org-node" style="border-color:'+lc+'"><div class="org-lvl" style="background:'+lc+'">'+ll+'</div><div class="org-nm">'+n.name+'</div><div class="org-cg">'+n.cargo+'</div></div>';
    if(sk.length)h+='<div class="org-line"></div>';h+=bT(n.id,lvl+1)+'</div>'}
    h+='</div>';return h}
  var root=nodes.find(function(n){return!n.parentId||n.parentId===null});
  if(!root)return '<div class="card"><div class="empty">Sem nÃ³ raiz</div></div>';
  var sk=getK(root.id);
  var tree='<div class="org-tree"><div class="org-branch"><div class="org-node" style="border-color:var(--acc);min-width:180px;padding:14px 20px"><div class="org-lvl" style="background:var(--acc)">CEO</div><div class="org-nm" style="font-size:15px">'+root.name+'</div><div class="org-cg">'+root.cargo+'</div></div>';
  if(sk.length)tree+='<div class="org-line"></div>';
  tree+=bT(root.id,1)+'</div></div>';
  return '<div class="card"><div class="card-tt" style="margin-bottom:14px">ğŸ¢ Organograma â€” FRC ('+nodes.length+' pessoas)</div><div style="overflow-x:auto">'+tree+'</div></div>';
}

// ===== SECTOR =====
function rSec(id){
  var cfg=SECTORS.find(function(s){return s.id===id});if(!cfg)return"";
  var d=gS(id);
  var hd='<div class="pg-hd"><div class="pg-tt"><span>'+cfg.icon+'</span> '+cfg.name+'</div><span class="pg-badge" style="background:'+cfg.color+'22;color:'+cfg.color+'">'+cfg.group+'</span></div><div class="tabs">'+STABS.map(function(t){return '<div class="tab '+(TB===t.id?"act":"")+'" onclick="TB=\''+t.id+'\';R()">'+t.i+' '+t.l+'</div>'}).join("")+'</div>';
  if(TB==="vision")return hd+vVision(d);
  if(TB==="pendencias")return hd+vPend(d);
  if(TB==="tarefas")return hd+vTarefas(d);
  if(TB==="entregas")return hd+vEntregas(d);
  if(TB==="kpimetas")return hd+vKpiMetas(id,d);
  if(TB==="rotinas")return hd+vRotinas(d);
  if(TB==="fluxo")return hd+vFluxo(d);
  if(TB==="orgsetor")return hd+vOrgS(d);
  if(TB==="comissao")return hd+vComissao(d);
  if(TB==="notes")return hd+vNotes(d);
  return hd;
}

// ===== VIEW FUNCTIONS =====
function vVision(d){
  var v=d.vision||{};
  if(!v.mission&&!v.gargalo&&!v.meta2026)return '<div class="card"><div class="empty"><div class="empty-ic">ğŸ¯</div>VisÃ£o nÃ£o preenchida</div></div>';
  return '<div class="card"><div class="card-tt" style="margin-bottom:14px">ğŸ¯ VisÃ£o do Setor</div><div class="vis-grid"><div><div class="vis-lb">MissÃ£o</div><div class="vis-val">'+(v.mission||"â€”")+'</div></div><div><div class="vis-lb">Maior Gargalo</div><div class="vis-val">'+(v.gargalo||"â€”")+'</div></div></div><div style="margin-top:14px"><div class="vis-lb">Meta 2026</div><div class="vis-val">'+(v.meta2026||"â€”")+'</div></div></div>';
}

function vPend(d){
  var it=d.pendencias||[];
  var q1=it.filter(function(x){return x.urgente&&x.importante&&x.status!=="ConcluÃ­do"});
  var q2=it.filter(function(x){return!x.urgente&&x.importante&&x.status!=="ConcluÃ­do"});
  var q3=it.filter(function(x){return x.urgente&&!x.importante&&x.status!=="ConcluÃ­do"});
  var q4=it.filter(function(x){return!x.urgente&&!x.importante&&x.status!=="ConcluÃ­do"});
  function ei(x){return '<div class="eis-item"><div style="font-weight:600">'+x.desc+'</div><div class="eis-item-meta"><span class="bdg '+(stMap[x.status]||'bdg-p')+'">'+x.status+'</span><span>ğŸ‘¤ '+(x.responsavel||"â€”")+'</span><span>â° '+(x.dateConcluir||"â€”")+'</span></div></div>'}
  if(!it.length)return '<div class="card"><div class="empty"><div class="empty-ic">âœ…</div>Sem pendÃªncias</div></div>';
  return '<div class="card"><div class="card-hd"><div class="card-tt">ğŸ”´ PendÃªncias â€” Eisenhower</div><span style="font-size:11px;color:var(--tx3)">'+it.filter(function(x){return x.status!=="ConcluÃ­do"}).length+' abertas</span></div><div class="eis-grid"><div class="eis-quad" style="border-color:var(--red)"><div class="eis-hd" style="color:var(--red)">ğŸ”¥ Urgente + Importante ('+q1.length+')</div>'+q1.map(ei).join("")+'</div><div class="eis-quad" style="border-color:var(--blu)"><div class="eis-hd" style="color:var(--blu)">ğŸ“‹ Importante ('+q2.length+')</div>'+q2.map(ei).join("")+'</div><div class="eis-quad" style="border-color:var(--ylw)"><div class="eis-hd" style="color:var(--ylw)">âš¡ Urgente ('+q3.length+')</div>'+q3.map(ei).join("")+'</div><div class="eis-quad" style="border-color:var(--tx3)"><div class="eis-hd" style="color:var(--tx3)">ğŸ“‚ Baixa ('+q4.length+')</div>'+q4.map(ei).join("")+'</div></div></div>';
}

function vTarefas(d){
  var it=d.tarefas||[];
  if(!it.length)return '<div class="card"><div class="empty"><div class="empty-ic">âœ…</div>Sem tarefas</div></div>';
  var rows='';for(var i=0;i<it.length;i++){var x=it[i];rows+='<tr><td>'+x.desc+'</td><td>'+(x.responsavel||"â€”")+'</td><td style="font-size:11px">'+(x.previsao||"â€”")+'</td><td style="font-size:11px">'+(x.deps||"â€”")+'</td><td><span class="bdg '+(stMap[x.status]||"bdg-p")+'">'+x.status+'</span></td></tr>'}
  return '<div class="card"><div class="card-hd"><div class="card-tt">ğŸŸ  Tarefas</div><span style="font-size:11px;color:var(--tx3)">'+it.filter(function(x){return x.status!=="ConcluÃ­do"}).length+' abertas</span></div><div class="tw"><table><thead><tr><th>Tarefa</th><th>ResponsÃ¡vel</th><th>PrevisÃ£o</th><th>Deps</th><th>Status</th></tr></thead><tbody>'+rows+'</tbody></table></div></div>';
}

function vEntregas(d){
  var mk=String(EMO);var items=(d.entregas||{})[mk]||[];
  var h='<div class="card"><div class="card-hd"><div class="card-tt">ğŸ“¦ Entregas â€” '+MOS[EMO]+' 2026</div><span style="font-size:11px;color:var(--tx3)">'+items.length+' total</span></div>'+mPills(EMO,"EMO");
  for(var sem=1;sem<=5;sem++){
    var wk=items.filter(function(x){return x.semana===sem});
    h+='<div style="margin-bottom:12px"><div style="font-size:11px;font-weight:700;color:var(--acc);margin-bottom:6px">â–¸ SEMANA '+sem+' ('+wk.length+')</div>';
    if(!wk.length){h+='<div style="font-size:11px;color:var(--tx3);font-style:italic">Nenhuma entrega</div>'}
    else{h+='<div class="tw"><table><thead><tr><th>Entrega</th><th>Status</th><th>Impacto</th><th>ResponsÃ¡vel</th><th>Validou</th><th>Obs</th></tr></thead><tbody>';
    for(var j=0;j<wk.length;j++){var x=wk[j];h+='<tr><td>'+x.desc+'</td><td><span class="bdg '+(stMap[x.status]||"bdg-p")+'">'+x.status+'</span></td><td style="font-size:10px">'+x.impacto+'</td><td>'+x.responsavel+'</td><td>'+(x.validador||"â€”")+'</td><td style="font-size:10px">'+(x.obs||"â€”")+'</td></tr>'}
    h+='</tbody></table></div>'}
    h+='</div>';
  }
  return h+'</div>';
}

function mPills(sel,vn){return '<div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:16px">'+MOS.map(function(m,i){return '<div onclick="'+vn+'='+i+';R()" style="padding:5px 12px;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;'+(i===sel?'background:var(--acc);color:#fff':'background:var(--bg3);color:var(--tx2);border:1px solid var(--bdr)')+'">'+m+'</div>'}).join('')+'</div>'}

function vKpiMetas(id,d){
  var metas=d.kpimetas||[];var v=d.vision||{};
  if(KMETA!==null&&KMETA<metas.length)return vKpiDetail(metas[KMETA]);
  var rows='';
  for(var i=0;i<metas.length;i++){var mt=metas[i];var nk=(mt.kpis||[]).length;
  rows+='<div style="background:var(--bg3);border:1px solid var(--bdr);border-radius:8px;padding:12px;margin-bottom:8px;cursor:pointer;display:flex;justify-content:space-between;align-items:center" onclick="KMETA='+i+';R()"><div><div style="font-size:13px;font-weight:700">'+mt.name+'</div><div style="font-size:10px;color:var(--tx3)">'+nk+' KPIs'+(nk<3?' â€” âš ï¸ mÃ­nimo 3':'')+'</div></div><span style="font-size:11px;color:var(--acc)">Ver â†’</span></div>'}
  return '<div class="card"><div class="card-hd"><div class="card-tt">ğŸ“Š KPIs & Metas</div><span style="font-size:11px;color:var(--tx3)">'+metas.length+' metas</span></div>'+
    (v.meta2026?'<div style="background:var(--bg3);border-left:3px solid var(--acc);padding:10px 14px;border-radius:0 8px 8px 0;margin-bottom:14px;font-size:12px"><span style="font-size:9px;text-transform:uppercase;letter-spacing:1px;color:var(--acc);font-weight:700">META 2026</span><br>'+v.meta2026+'</div>':'')+
    (!metas.length?'<div class="empty"><div class="empty-ic">ğŸ“Š</div>Sem metas</div>':rows)+'</div>';
}

function vKpiDetail(mt){
  var mo=KMO;var mk=String(mo);
  var h='<div class="card"><div class="card-hd"><div class="card-tt">ğŸ“Š '+mt.name+'</div><button class="btn" style="background:var(--bg3);color:var(--tx2);border:1px solid var(--bdr);font-size:11px;padding:4px 10px;cursor:pointer" onclick="KMETA=null;R()">â† Voltar</button></div>'+mPills(mo,"KMO");
  for(var k=0;k<(mt.kpis||[]).length;k++){
    var kp=mt.kpis[k];var wd=(kp.weekData||{})[mk]||[{},{},{},{},{}];
    h+='<div style="margin-bottom:16px"><div style="font-size:12px;font-weight:700;color:var(--blu);margin-bottom:8px">ğŸ“Œ '+kp.name+'</div><div class="tw"><table><thead><tr><th>Semana</th><th>Meta</th><th>Realizado</th><th>Atingido</th><th>Gap</th><th>Progresso</th></tr></thead><tbody>';
    for(var w=0;w<5;w++){
      var wd1=wd[w]||{};var metaV=parseFloat(wd1.meta)||0;var realV=parseFloat(wd1.realizado)||0;var pct=metaV?Math.round((realV/metaV)*100):0;var gap=metaV?(realV-metaV):0;var col=pct>=80?'var(--grn)':pct>=50?'var(--ylw)':'var(--red)';if(!metaV)col='var(--tx3)';
      h+='<tr><td style="font-weight:600">Sem '+(w+1)+'</td><td>'+(wd1.meta||"â€”")+'</td><td>'+(wd1.realizado||"â€”")+'</td><td style="font-family:Space Mono;font-weight:700;color:'+col+'">'+(metaV?pct+'%':'â€”')+'</td><td style="color:'+(gap>=0?'var(--grn)':'var(--red)')+'">'+(metaV?(gap>=0?'+':'')+gap:'â€”')+'</td><td><div style="width:60px;height:4px;background:var(--bg4);border-radius:2px"><div style="height:100%;width:'+Math.min(pct,100)+'%;background:'+col+';border-radius:2px"></div></div></td></tr>'
    }
    h+='</tbody></table></div></div>';
  }
  var md=(mt.data||{})[mk]||{};
  if(md.projecao||md.acao||md.erro){h+='<div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px"><div><div class="vis-lb">ProjeÃ§Ã£o MÃªs</div><div class="vis-val">'+(md.projecao||"â€”")+'</div></div><div><div class="vis-lb">AÃ§Ã£o Relevante</div><div class="vis-val">'+(md.acao||"â€”")+'</div></div><div><div class="vis-lb">Maior Erro</div><div class="vis-val">'+(md.erro||"â€”")+'</div></div></div>'}
  return h+'</div>';
}

function vRotinas(d){
  var items=d.rotinas||[];
  var filtered=RFILT==="todos"?items:items.filter(function(x){return x.freq===RFILT});
  var freqs=["todos","diario","semanal","quinzenal","mensal"];
  var list='';
  if(!filtered.length){list='<div class="empty"><div class="empty-ic">ğŸ“…</div>Sem rotinas</div>'}
  else{for(var i=0;i<filtered.length;i++){var r=filtered[i];var fc=FREQ_COLS[r.freq]||'var(--tx3)';
  list+='<div class="rot-card"><div style="display:flex;align-items:center;gap:8px;margin-bottom:4px"><span class="rot-freq" style="background:'+fc+'22;color:'+fc+'">'+r.freq+'</span><span style="font-size:12px;font-weight:700">'+r.titulo+'</span></div>';
  if(r.dia)list+='<div style="font-size:10px;color:var(--tx3)">ğŸ” '+r.dia+'</div>';
  if(r.setor)list+='<div style="font-size:10px;color:var(--tx3)">ğŸ“‚ '+r.setor+'</div>';
  if(r.explicacao)list+='<div style="font-size:11px;color:var(--tx2);margin-top:4px">'+r.explicacao+'</div>';
  if(r.tarefa)list+='<div style="font-size:11px;color:var(--acc);margin-top:2px">â†’ '+r.tarefa+'</div>';
  list+='</div>'}}
  return '<div class="card"><div class="card-hd"><div class="card-tt">ğŸ“… Rotinas</div><span style="font-size:11px;color:var(--tx3)">'+items.length+' rotinas</span></div><div class="rf">'+freqs.map(function(f){return '<div class="rf-btn'+(RFILT===f?' act':'')+'" onclick="RFILT=\''+f+'\';R()">'+f.charAt(0).toUpperCase()+f.slice(1)+'</div>'}).join('')+'</div>'+list+'</div>'+
  '<div class="card"><div class="card-tt" style="margin-bottom:14px">ğŸ“† CalendÃ¡rio 2026</div>'+buildCal(CALMO,CALYR)+'<div style="margin-top:10px;display:flex;gap:12px;font-size:10px;color:var(--tx3)"><span>ğŸ‡§ğŸ‡· <span style="color:var(--grn)">Brasil</span></span><span>ğŸ‡ºğŸ‡¸ EUA</span><span style="color:var(--acc)">â— Hoje</span></div></div>';
}
function buildCal(mo,yr){
  var first=new Date(yr,mo,1);var last=new Date(yr,mo+1,0);var startDay=first.getDay();var days=last.getDate();var todayStr=new Date().toISOString().slice(0,10);
  var html='<div class="cal"><div class="cal-nav"><button onclick="CALMO--;if(CALMO<0){CALMO=11;CALYR--}R()">â—€</button><div class="cal-nav-tt">'+MOS[mo]+' '+yr+'</div><button onclick="CALMO++;if(CALMO>11){CALMO=0;CALYR++}R()">â–¶</button></div><div class="cal-hd"><div>Dom</div><div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>SÃ¡b</div></div><div class="cal-body">';
  for(var e=0;e<startDay;e++)html+='<div class="cal-day empty"></div>';
  for(var d=1;d<=days;d++){var ds=yr+'-'+String(mo+1).padStart(2,'0')+'-'+String(d).padStart(2,'0');var isT=ds===todayStr;var hol=HOLIDAYS[ds];
  html+='<div class="cal-day'+(isT?' today':'')+(hol?' hol':'')+'">'+d;if(hol)html+='<div class="cal-hol'+(hol.f.indexOf('ğŸ‡§ğŸ‡·')>=0?' cal-hol-br':'')+'">'+hol.f+' '+hol.t+'</div>';html+='</div>'}
  return html+'</div></div>';
}

function vFluxo(d){
  var items=(d.fluxo||[]).slice().sort(function(a,b){return(a.ordem||0)-(b.ordem||0)});
  if(!items.length)return '<div class="card"><div class="empty"><div class="empty-ic">ğŸ”€</div>Fluxo nÃ£o configurado</div></div>';
  var flow='';
  for(var i=0;i<items.length;i++){var s=items[i];
  flow+='<div class="flow-node" style="border-color:'+(s.penalidade?'var(--ylw)':'var(--bdr)')+'"><div style="font-size:9px;color:var(--tx3);position:absolute;top:4px;left:8px">'+s.ordem+'</div><div style="font-size:13px;font-weight:700;margin-bottom:2px">'+s.titulo+'</div>';
  if(s.responsavel)flow+='<div style="font-size:10px;color:var(--tx2)">ğŸ‘¤ '+s.responsavel+'</div>';
  if(s.descricao)flow+='<div style="font-size:11px;color:var(--tx2);margin-top:4px">'+s.descricao+'</div>';
  if(s.penalidade)flow+='<div class="flow-pen">âš ï¸ '+s.penalidade+'</div>';
  flow+='</div>';if(i<items.length-1)flow+='<div class="flow-arrow">â–¼</div>'}
  return '<div class="card"><div class="card-hd"><div class="card-tt">ğŸ”€ Fluxo do Setor</div><span style="font-size:11px;color:var(--tx3)">'+items.length+' etapas</span></div><div style="max-width:500px;margin:0 auto">'+flow+'</div></div>';
}

function vOrgS(d){
  var nodes=d.orgNodes||[];
  if(!nodes.length)return '<div class="card"><div class="empty"><div class="empty-ic">ğŸ¢</div>Organograma nÃ£o configurado</div></div>';
  function getK(pid){return nodes.filter(function(n){return n.parentId===pid})}
  function bT(pid,lvl){var kids=getK(pid);if(!kids.length)return'';var h='<div class="org-children">';for(var i=0;i<kids.length;i++){var n=kids[i];var sk=getK(n.id);var lc=lvl===0?'var(--acc)':lvl===1?'var(--blu)':'var(--pur)';var ll=lvl===0?'LÃ­der':lvl===1?'Sub':'Equipe';h+='<div class="org-branch"><div class="org-node" style="border-color:'+lc+'"><div class="org-lvl" style="background:'+lc+'">'+ll+'</div><div class="org-nm">'+n.name+'</div><div class="org-cg">'+n.cargo+'</div></div>';if(sk.length)h+='<div class="org-line"></div>';h+=bT(n.id,lvl+1)+'</div>'}h+='</div>';return h}
  var roots=nodes.filter(function(n){return!n.parentId||n.parentId===""});
  if(!roots.length)return '<div class="card"><div class="empty">Sem lÃ­der definido</div></div>';
  var tree='<div class="org-tree">';
  for(var r=0;r<roots.length;r++){var root=roots[r];var sk=getK(root.id);tree+='<div class="org-branch"><div class="org-node" style="border-color:var(--acc)"><div class="org-lvl" style="background:var(--acc)">LÃ­der</div><div class="org-nm">'+root.name+'</div><div class="org-cg">'+root.cargo+'</div></div>';if(sk.length)tree+='<div class="org-line"></div>';tree+=bT(root.id,1)+'</div>'}
  tree+='</div>';
  return '<div class="card"><div class="card-hd"><div class="card-tt">ğŸ¢ Organograma</div><span style="font-size:11px;color:var(--tx3)">'+nodes.length+' pessoas</span></div><div style="overflow-x:auto">'+tree+'</div></div>';
}

function vComissao(d){
  var c=d.comissao||{};
  var lvlCards='<div class="com-lvl">';
  for(var i=0;i<LVLS.length;i++){var lv=LVLS[i];var nv=(c.niveis||{})[lv.id]||{};
  lvlCards+='<div class="com-card"><div class="bar" style="background:'+lv.color+'"></div><div class="com-icon">'+lv.icon+'</div><div class="com-nm">'+lv.name+'</div><div class="com-pct">'+lv.pct+'</div><div class="com-val" style="color:'+lv.color+'">'+(nv.valor||"â€”")+'</div></div>'}
  lvlCards+='</div>';
  var regras='';for(var r=0;r<(c.regras||[]).length;r++){regras+='<div style="background:var(--bg3);border:1px solid var(--bdr);border-radius:6px;padding:8px 10px;margin-bottom:6px;font-size:12px">'+c.regras[r].texto+'</div>'}
  return '<div class="card"><div class="card-tt" style="margin-bottom:14px">ğŸ’² Comissionamento</div>'+
    (c.ajudaCusto?'<div style="margin-bottom:14px"><div class="vis-lb">Ajuda de Custo</div><div class="vis-val">'+c.ajudaCusto+'</div></div>':'')+
    '<div class="vis-lb" style="margin-bottom:10px">NÃ­veis de Atingimento</div>'+lvlCards+
    ((c.regras||[]).length?'<div style="margin-top:14px"><div class="vis-lb" style="margin-bottom:8px">Regras</div>'+regras+'</div>':'')+
    '</div>';
}

function vNotes(d){
  if(!d.notes)return '<div class="card"><div class="empty"><div class="empty-ic">ğŸ“</div>Sem notas</div></div>';
  return '<div class="card"><div class="card-tt" style="margin-bottom:14px">ğŸ“ Notas do CEO</div><div class="vis-val">'+d.notes+'</div></div>';
}

load();R();
setInterval(function(){load();R()},3000);
</script>
</body>
</html>
